这是一个关于微信交易、支付宝交易账单的记账本。
支持多账户管理、多币种记账、预算管理、数据可视化等功能。数据库是本地的不需要担心数据泄露

## 功能特性

（1）个人账户余额统计，支持定义多个账户，如支付宝、微信、银行卡等等
（2）交易账单的导入，支持一xlxs的一键导入（仅包含表头，需要手动删掉微信/支付宝导出的前面部分）
（3）交易分类自定义（支持多种交易分类的自定义、模糊定义、模糊查询）交易分类自定义（支持多种交易分类的自定义、模糊定义、模糊查询）
（4）整体数据导入/导出保存
（5）每个月收支情况的报表、预算查看、每个月的消费查询、交易明细查看
（6）所有流水都支持修改和重新编辑

## 使用方式

### 方式一：作为网页使用
直接在浏览器中打开 `index.html` 文件即可使用。数据存储在浏览器的 IndexedDB 中（数据库名：`ledger_v1`）。

⚠️ **注意**：作为网页使用时，如果清除浏览器的站点数据，记账数据将会被删除。

### 方式二：作为浏览器扩展使用（推荐）

本应用支持作为 Chrome/Firefox 浏览器扩展运行。扩展模式下的优势：

✅ **数据持久化**：扩展使用独立的 IndexedDB 存储（数据库名：`ledger_ext_v1`），清除站点数据不会影响记账数据
✅ **快速访问**：点击工具栏图标即可快速打开应用
✅ **独立环境**：与普通网页数据隔离，更安全可靠

#### 安装方法

**Chrome/Edge 浏览器：**

1. 打开浏览器，访问 `chrome://extensions/`（Edge 浏览器访问 `edge://extensions/`）
2. 打开右上角的"开发者模式"开关
3. 点击"加载已解压的扩展程序"按钮
4. 选择本项目的根目录文件夹（包含 `manifest.json` 的目录）
5. 扩展安装完成后，点击浏览器工具栏上的扩展图标即可打开记账本

**Firefox 浏览器：**

1. 打开浏览器，访问 `about:debugging#/runtime/this-firefox`
2. 点击"临时载入附加组件"按钮
3. 选择本项目根目录中的 `manifest.json` 文件
4. 扩展安装完成后，点击浏览器工具栏上的扩展图标即可打开记账本

#### 验证扩展数据存储

安装扩展并创建一些账户/交易后，可以通过以下方式验证数据持久化：

1. 打开浏览器开发者工具（F12）
2. 切换到"Application"（应用程序）或"Storage"（存储）标签页
3. 在左侧导航栏找到"IndexedDB"
4. 应该能看到 `ledger_ext_v1` 数据库及其中的数据表（accounts、transactions、budgets、prefs、fxrates）

#### 扩展与网页的数据隔离

- **扩展模式**：数据存储在 `ledger_ext_v1` 数据库中，清除站点数据不会影响
- **网页模式**：数据存储在 `ledger_v1` 数据库中，清除站点数据会删除

两种模式的数据是完全独立的，可以通过导入/导出功能在两者之间迁移数据。

## 代码目录结构

```
ledger/
├── manifest.json       # 浏览器扩展配置文件（Manifest V3）
├── background.js       # 扩展后台服务脚本
├── index.html          # 主HTML文件
├── css/
│   └── main.css        # 所有样式文件
└── js/
    ├── utils.js        # 工具函数
    ├── db.js           # IndexedDB数据库操作（网页模式）
    ├── extension-idb.js # IndexedDB适配器（扩展模式）
    ├── state.js        # 全局状态管理
    ├── theme.js        # 主题管理
    ├── fx.js           # 汇率相关功能
    ├── account.js      # 账户管理
    ├── transaction.js  # 交易管理
    ├── budget.js       # 预算管理
    ├── category.js     # 分类管理
    ├── reports.js      # 报表功能
    ├── import-export.js # 导入导出功能
    ├── render.js       # 渲染函数
    ├── events.js       # 事件绑定
    └── main.js         # 主入口文件
```

使用的情况截图：
