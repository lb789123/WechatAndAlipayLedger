diff --git a/index.html b/index.html
index 7a9c8df..f0b325e 100644
--- a/index.html
+++ b/index.html
@@ -214,13 +214,20 @@
             <div class="space"></div>
             <div class="row" style="gap:8px;align-items:center">
               <label class="muted">视图：</label>
-              <select id="budgetViewMode"
-                style="padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:var(--panel-2);color:var(--text)">
-                <option value="month">按月</option>
-                <option value="year">按年</option>
-              </select>
-
-              <label class="muted">查询月份：</label>
-              <input type="month" id="budgetMonthSelector"
-                style="padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:var(--panel-2);color:var(--text)" />
+              <select id="budgetViewMode"
+                style="padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:var(--panel-2);color:var(--text)">
+                <option value="month">按月</option>
+                <option value="year">按年</option>
+              </select>
+
+              <!-- 按月查询控件 -->
+              <label class="muted" id="budgetMonthLabelControl">查询月份：</label>
+              <input type="month" id="budgetMonthSelector"
+                style="padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:var(--panel-2);color:var(--text)" />
+
+              <!-- 按年查询控件（仅在视图=按年 时显示） -->
+              <label class="muted" id="budgetYearLabelControl" style="display:none;">查询年份：</label>
+              <select id="budgetYearSelector"
+                style="display:none;padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:var(--panel-2);color:var(--text)">
+              </select>
               <button class="btn" id="btnResetBudgetMonth" title="回到当前月">本月</button>
             </div>
           </div>
-          <div class="row" style="margin-top:8px"><span class="muted" id="budgetMonthLabel"></span></div>
+          <div class="row" style="margin-top:8px"><span class="muted" id="budgetMonthLabel"></span></div>
           <div class="grid g-3" id="budgetGrid" style="margin-top:12px"></div>
         </div>
       </div>
@@ -228,9 +235,8 @@
       <div class="content" id="budgetFormCard" class="collapsed"></div>
       </div>
 
-      <!-- 替换为可折叠结构 -->
-      <div class="card collapsed" id="budgetFormCard">
-        <div class="content">
+      <!-- 可折叠预算设置 -->
+      <div class="card collapsed" id="budgetFormCard">
+        <div class="content">
           <div class="row">
             <h3>设置预算</h3>
             <span class="pill editing-badge" id="bdgEditingPill">✏️ 正在编辑预算</span>
diff --git a/js/events.js b/js/events.js
index 0d63c3f..f27b96d 100644
--- a/js/events.js
+++ b/js/events.js
@@ -130,19 +130,60 @@ function bindEvents(){
   $('#btnCancelEditBudget').onclick=()=>{if(window.endEditBudget) window.endEditBudget();};
   
   // 预算月份选择器
-    const budgetViewMode = $('#budgetViewMode');
-    const budgetMonthSelector = $('#budgetMonthSelector');
-    if (budgetMonthSelector) {
-      const now = new Date();
-      const year = now.getFullYear();
-      const month = String(now.getMonth() + 1).padStart(2, '0');
-      budgetMonthSelector.value = `${year}-${month}`;
-    }
-  
-    function refreshBudgetByControls() {
-      if (!window.renderBudget) return;
-      const mode = budgetViewMode ? budgetViewMode.value : 'month';
-      const monthValue = budgetMonthSelector ? budgetMonthSelector.value : null;
-      window.renderBudget(monthValue || null, mode);
-      if (window.closeBudgetDetail) window.closeBudgetDetail();
-    }
-  
-    if (budgetViewMode) {
-      budgetViewMode.onchange = () => {
-        refreshBudgetByControls();
-      };
-    }
-  
-    if (budgetMonthSelector) {
-      budgetMonthSelector.onchange = () => {
-        refreshBudgetByControls();
-      };
-    }
+  const budgetViewMode      = $('#budgetViewMode');
+  const budgetMonthSelector = $('#budgetMonthSelector');
+  const budgetYearSelector  = $('#budgetYearSelector');
+  const lblMonthCtrl        = $('#budgetMonthLabelControl');
+  const lblYearCtrl         = $('#budgetYearLabelControl');
+
+  // 初始化月份为当前月
+  if (budgetMonthSelector) {
+    const now = new Date();
+    const year = now.getFullYear();
+    const month = String(now.getMonth() + 1).padStart(2, '0');
+    budgetMonthSelector.value = `${year}-${month}`;
+  }
+
+  // 初始化年份下拉：从当前年份往前 10 年
+  if (budgetYearSelector) {
+    const nowY = new Date().getFullYear();
+    budgetYearSelector.innerHTML = '';
+    for (let y = nowY; y >= nowY - 10; y--) {
+      const opt = document.createElement('option');
+      opt.value = String(y);
+      opt.textContent = String(y);
+      budgetYearSelector.appendChild(opt);
+    }
+    budgetYearSelector.value = String(nowY);
+  }
+
+  function refreshBudgetByControls() {
+    if (!window.renderBudget) return;
+    const mode = budgetViewMode ? budgetViewMode.value : 'month';
+
+    if (mode === 'year') {
+      const yearVal = budgetYearSelector ? budgetYearSelector.value : null;
+      window.renderBudget(yearVal || null, 'year');
+    } else {
+      const monthValue = budgetMonthSelector ? budgetMonthSelector.value : null;
+      window.renderBudget(monthValue || null, 'month');
+    }
+    if (window.closeBudgetDetail) window.closeBudgetDetail();
+  }
+
+  // 根据视图切换显示不同的查询控件
+  function syncBudgetQueryControls() {
+    const mode = budgetViewMode ? budgetViewMode.value : 'month';
+    if (!lblMonthCtrl || !lblYearCtrl || !budgetMonthSelector || !budgetYearSelector) return;
+    if (mode === 'year') {
+      lblMonthCtrl.style.display = 'none';
+      budgetMonthSelector.style.display = 'none';
+      lblYearCtrl.style.display = '';
+      budgetYearSelector.style.display = '';
+    } else {
+      lblMonthCtrl.style.display = '';
+      budgetMonthSelector.style.display = '';
+      lblYearCtrl.style.display = 'none';
+      budgetYearSelector.style.display = 'none';
+    }
+  }
+
+  if (budgetViewMode) {
+    budgetViewMode.onchange = () => {
+      syncBudgetQueryControls();
+      refreshBudgetByControls();
+    };
+    // 初始同步一次
+    syncBudgetQueryControls();
+  }
+
+  if (budgetMonthSelector) {
+    budgetMonthSelector.onchange = () => {
+      if (budgetViewMode && budgetViewMode.value === 'month') {
+        refreshBudgetByControls();
+      }
+    };
+  }
+
+  if (budgetYearSelector) {
+    budgetYearSelector.onchange = () => {
+      if (budgetViewMode && budgetViewMode.value === 'year') {
+        refreshBudgetByControls();
+      }
+    };
+  }
@@ -190,11 +231,20 @@ function bindEvents(){
   
   // 重置到当前月按钮
   $('#btnResetBudgetMonth').onclick = ()=>{
-        if (budgetMonthSelector) {
-            const now = new Date();
-            const year = now.getFullYear();
-            const month = String(now.getMonth() + 1).padStart(2, '0');
-            budgetMonthSelector.value = `${year}-${month}`;
-          }
-          refreshBudgetByControls();
+    if (budgetViewMode && budgetViewMode.value === 'year') {
+      // 年度模式：重置为当前年份
+      if (budgetYearSelector) {
+        const now = new Date();
+        const year = now.getFullYear();
+        budgetYearSelector.value = String(year);
+      }
+    } else {
+      // 按月模式：重置为当前月
+      if (budgetMonthSelector) {
+        const now = new Date();
+        const year = now.getFullYear();
+        const month = String(now.getMonth() + 1).padStart(2, '0');
+        budgetMonthSelector.value = `${year}-${month}`;
+      }
+    }
+    refreshBudgetByControls();
   };
diff --git a/js/render.js b/js/render.js
index 9f1c7e8..bc1bf2b 100644
--- a/js/render.js
+++ b/js/render.js
@@ -1,8 +1,92 @@
 // ====== 渲染函数 ======
 function renderAll(){ 
   [...]
 }
-+
-+// 计算某分类在指定范围内的预算已用额度（支出为负、收入为正，取净支出的正值）
-+function calcBudgetUsedForCategory(cat, year, monthOrNullForYearView) {
-  [...]
-}
+
+// 计算某分类在指定范围内的预算已用额度
+// 逻辑：该分类下的“收入总和 + 支出总和”（支出为负数、收入为正数），
+// 用于预算卡片中显示“已用/结余”等信息。
+// year: 数字年份
+// monthOrNullForYearView: 1-12 表示某个月；null 表示整年（1 月 1 日 - 12 月 31 日）
+function calcBudgetUsedForCategory(cat, year, monthOrNullForYearView) {
+  if (!window.state) return 0;
+  const state = window.state;
+
+  let total = 0;
+  const isYearView = (monthOrNullForYearView == null);
+
+  state.txs.forEach(t => {
+    if (t.isTransfer) return;           // 转账不计入预算
+    if (t.category !== cat) return;
+
+    const d = new Date(t.date);
+    if (!d || isNaN(d)) return;
+
+    if (d.getFullYear() !== year) return;
+    if (!isYearView) {
+      const m = d.getMonth() + 1;
+      if (m !== monthOrNullForYearView) return;
+    }
+
+    const acc = state.accounts.find(a => a.id === t.accountId);
+    if (!acc) return;
+    const v = amountToBase(t.amount, acc.currency);
+    if (v === null) return;
+
+    if (t.side === 'out') {
+      total -= v; // 支出为负
+    } else if (t.side === 'in') {
+      total += v; // 收入为正
+    }
+  });
+
+  return total;
+}
@@ -138,53 +222,162 @@ function renderTxTable(){
   });
 }
 
-// 预算渲染：支持按月/按年视图 + 退款计入 + 进度条颜色
-function renderBudget(targetMonth = null, viewMode = 'month') {
-  [...]
-      btnDetail.onclick = (e) => {
-        [...]
-      };
-    }
-    if (btnEdit) {
-      btnEdit.onclick = (e) => {
-        e.stopPropagation();
-        if (window.startEditBudget) window.startEditBudget(cat);
-      };
-    }
-    if (btnDel) {
-      btnDel.onclick = (e) => {
-        e.stopPropagation();
-        if (window.deleteBudget) window.deleteBudget(cat);
-      };
-  [...]
-}
-
-function renderBudget(targetMonth = null){
-  [...]
-    b.onclick=(e)=>{
-      e.stopPropagation();
-      if(window.startEditBudget) window.startEditBudget(b.dataset.bdgEdit);
-    };
-  [...]
-    b.onclick=(e)=>{
-      e.stopPropagation();
-      if(window.deleteBudget) window.deleteBudget(b.dataset.bdgDel);
-    };
-  });
-}
-
-// 显示预算分类的交易明细
-function showBudgetDetail(category, month){
-  [...]
-}
-
-// 关闭预算明细
-function closeBudgetDetail(){
-  const detailCard = $('#budgetDetailCard');
-  detailCard.style.display = 'none';
-}
+// 预算渲染：统一的实现，支持按月/按年视图 + 收入/支出汇总 + 进度条颜色
+// target: 若 viewMode='month' 则为 'YYYY-MM'；若 viewMode='year' 则为 'YYYY'
+function renderBudget(target = null, viewMode = 'month') {
+  if (!window.state) return;
+  const state = window.state;
+
+  const grid = $('#budgetGrid');
+  if (!grid) return;
+
+  grid.innerHTML = '';
+
+  // 解析时间范围
+  const now = new Date();
+  let year, month;
+  if (viewMode === 'year') {
+    // 按年：target 为 'YYYY' 或 null
+    year = target ? parseInt(String(target), 10) : now.getFullYear();
+    month = null; // 整年
+  } else {
+    // 按月：target 为 'YYYY-MM' 或 null
+    let ymStr = target;
+    if (!ymStr) {
+      const y = now.getFullYear();
+      const m = String(now.getMonth() + 1).padStart(2, '0');
+      ymStr = `${y}-${m}`;
+    }
+    const parts = String(ymStr).split('-');
+    year = parseInt(parts[0], 10);
+    month = parseInt(parts[1] || (now.getMonth() + 1), 10);
+  }
+
+  // 显示查询区下面的提示标签
+  const lbl = $('#budgetMonthLabel');
+  if (lbl) {
+    if (viewMode === 'year') {
+      lbl.textContent = `当前视图：${year} 年 · 基准货币：${state.prefs.baseCurrency}`;
+    } else {
+      const mm = String(month).padStart(2, '0');
+      lbl.textContent = `当前视图：${year}-${mm} · 基准货币：${state.prefs.baseCurrency}`;
+    }
+  }
+
+  // 没有预算配置时，直接提示
+  const cats = Object.keys(state.budgets || {});
+  if (cats.length === 0) {
+    grid.innerHTML = '<p class="muted">尚未设置任何预算，请在下方“设置预算”中新增。</p>';
+    return;
+  }
+
+  // 遍历所有已设置预算的分类，逐个渲染卡片
+  cats.forEach(cat => {
+    const monthlyBudget = Number(state.budgets[cat]) || 0;
+
+    let periodBudget;
+    if (viewMode === 'year') {
+      // 年视图：年度预算 = 月预算 * 12
+      periodBudget = monthlyBudget * 12;
+    } else {
+      // 月视图：本期预算 = 月预算
+      periodBudget = monthlyBudget;
+    }
+
+    // 计算本期已用额度（收入为正、支出为负）
+    const used = calcBudgetUsedForCategory(cat, year, viewMode === 'year' ? null : month);
+
+    // 对用户更直观的展示：支出用正数显示（例如：已用 = -800 → 显示 800）
+    const usedAbs = used < 0 ? -used : used;
+
+    // 剩余 / 超支
+    const remain = periodBudget - usedAbs;
+
+    // 进度（0-1）——用于进度条宽度
+    let ratio = periodBudget > 0 ? (usedAbs / periodBudget) : 0;
+    if (!isFinite(ratio)) ratio = 0;
+    if (ratio < 0) ratio = 0;
+    // ratio>1 表示超支
+
+    // 进度条颜色
+    let barClass = 'ok';
+    if (ratio >= 1.0) barClass = 'over';
+    else if (ratio >= 0.8) barClass = 'warn';
+
+    const baseCur = state.prefs.baseCurrency;
+
+    const card = document.createElement('div');
+    card.className = 'card budget-card';
+    card.innerHTML = `
+      <div class="content budget-item" data-bdg-cat="${cat}">
+        <div class="row" style="align-items:center;">
+          <h4>${cat}</h4>
+          <div class="space"></div>
+          <button class="btn ghost" data-bdg-detail="${cat}">明细</button>
+          <button class="btn" data-bdg-edit="${cat}" style="margin-left:4px">编辑</button>
+          <button class="btn warn" data-bdg-del="${cat}" style="margin-left:4px">删除</button>
+        </div>
+        <div class="row" style="margin-top:6px;">
+          <span class="muted">本期预算：</span>
+          <strong class="amount">${fmtAmount(periodBudget, baseCur)}</strong>
+        </div>
+        <div class="row" style="margin-top:4px;">
+          <span class="muted">本期收入-支出：</span>
+          <strong class="amount ${used >= 0 ? 'positive' : 'negative'}">
+            ${fmtAmount(used, baseCur)}
+          </strong>
+        </div>
+        <div class="row" style="margin-top:4px;">
+          <span class="muted">${remain >= 0 ? '剩余预算：' : '超支：'}</span>
+          <strong class="amount ${remain >= 0 ? '' : 'negative'}">
+            ${fmtAmount(Math.abs(remain), baseCur)}
+          </strong>
+        </div>
+        <div class="progress-wrap" style="margin-top:8px;">
+          <div class="progress-bar ${barClass}">
+            <div class="progress-inner" style="width:${Math.min(ratio, 1) * 100}%"></div>
+          </div>
+        </div>
+      </div>
+    `;
+
+    grid.appendChild(card);
+  });
+
+  // 绑定事件：整卡点击查看明细
+  $$('#budgetGrid .budget-item').forEach(el => {
+    const cat = el.dataset.bdgCat;
+    el.onclick = (e) => {
+      // 避免点击按钮时触发卡片点击
+      if ((e.target instanceof HTMLElement) && e.target.closest('button')) return;
+      const ymStr = (viewMode === 'year')
+        ? String(year)
+        : `${year}-${String(month).padStart(2, '0')}`;
+      if (window.showBudgetDetail) window.showBudgetDetail(cat, ymStr, viewMode);
+    };
+  });
+
+  // 绑定三个按钮：明细 / 编辑 / 删除
+  $$('[data-bdg-detail]').forEach(b => {
+    const cat = b.dataset.bdgDetail;
+    b.onclick = (e) => {
+      e.stopPropagation();
+      const ymStr = (viewMode === 'year')
+        ? String(year)
+        : `${year}-${String(month).padStart(2, '0')}`;
+      if (window.showBudgetDetail) window.showBudgetDetail(cat, ymStr, viewMode);
+    };
+  });
+
+  $$('[data-bdg-edit]').forEach(b => {
+    const cat = b.dataset.bdgEdit;
+    b.onclick = (e) => {
+      e.stopPropagation();
+      if (window.startEditBudget) window.startEditBudget(cat);
+    };
+  });
+
+  $$('[data-bdg-del]').forEach(b => {
+    const cat = b.dataset.bdgDel;
+    b.onclick = (e) => {
+      e.stopPropagation();
+      if (window.deleteBudget) window.deleteBudget(cat);
+    };
+  });
+}
+
+// 显示预算分类的交易明细
+// period: 若 viewMode='month' 则为 'YYYY-MM'；若 'year' 则为 'YYYY'
+function showBudgetDetail(category, period, viewMode = 'month'){
+  if (!window.state) return;
+  const state = window.state;
+
+  const tableBody = $('#budgetDetailTable tbody');
+  const titleEl   = $('#budgetDetailTitle');
+  const totalEl   = $('#budgetDetailTotal');
+  const card      = $('#budgetDetailCard');
+  if (!tableBody || !titleEl || !totalEl || !card) return;
+
+  const now = new Date();
+  let year, month = null;
+
+  if (viewMode === 'year') {
+    year = parseInt(String(period), 10) || now.getFullYear();
+  } else {
+    const parts = String(period).split('-');
+    year  = parseInt(parts[0], 10) || now.getFullYear();
+    month = parseInt(parts[1] || (now.getMonth() + 1), 10);
+  }
+
+  const rows = [];
+  let sum = 0;
+  const isYearView = (viewMode === 'year');
+
+  state.txs.forEach(t => {
+    if (t.isTransfer) return;
+    if (t.category !== category) return;
+
+    const d = new Date(t.date);
+    if (!d || isNaN(d)) return;
+    if (d.getFullYear() !== year) return;
+    if (!isYearView) {
+      const m = d.getMonth() + 1;
+      if (m !== month) return;
+    }
+
+    const acc = state.accounts.find(a => a.id === t.accountId);
+    if (!acc) return;
+    const vBase = amountToBase(t.amount, acc.currency);
+    if (vBase === null) return;
+
+    // 明细中，以支出为负、收入为正记录，统计净额
+    const signed = (t.side === 'out') ? -vBase : vBase;
+    sum += signed;
+
+    rows.push({
+      date: t.date,
+      account: acc.name,
+      payee: t.payee || '',
+      memo: t.memo || '',
+      amount: signed
+    });
+  });
+
+  // 渲染表格
+  tableBody.innerHTML = '';
+  rows.sort((a,b) => a.date.localeCompare(b.date));
+  rows.forEach(r => {
+    const tr = document.createElement('tr');
+    tr.innerHTML = `
+      <td>${r.date}</td>
+      <td>${r.account}</td>
+      <td>${r.payee || ''}</td>
+      <td>${r.memo || ''}</td>
+      <td style="text-align:right" class="${r.amount < 0 ? 'amount negative' : 'amount positive'}">
+        ${fmtAmount(r.amount, state.prefs.baseCurrency)}
+      </td>
+    `;
+    tableBody.appendChild(tr);
+  });
+
+  // 标题 & 合计
+  const periodLabel = (viewMode === 'year')
+    ? `${year} 年`
+    : `${year}-${String(month).padStart(2,'0')}`;
+  titleEl.textContent = `交易明细 · ${category} · ${periodLabel}`;
+  totalEl.textContent = fmtAmount(sum, state.prefs.baseCurrency);
+
+  card.style.display = 'block';
+}
+
+// 关闭预算明细
+function closeBudgetDetail(){
+  const detailCard = $('#budgetDetailCard');
+  if (detailCard) detailCard.style.display = 'none';
+}
 
 function renderFxTable(){
   [...]